#
# BaRS_ValidationResponse tstp file
# Use Case 999 to CAS
#
SCRIPT BaRS_ValidationResponse

BEGIN SCHEDULES
ValidationResponse_xml_accept TESTS ValidationResponseTest_xml_accept ResponseIsXml IntegrityRequestIDHeaderIsPresent IntegrityCorrelationIDHeaderIsPresent IntegrityRequestIDHeadersMatch IntegrityCorrelationIDHeadersMatch ResponseIsBundle
ValidationResponse_json_accept TESTS ValidationResponseTest_json_accept ResponseIsJson IntegrityRequestIDHeaderIsPresent IntegrityCorrelationIDHeaderIsPresent IntegrityRequestIDHeadersMatch IntegrityCorrelationIDHeadersMatch ResponseIsBundle
#ExtractedValidationResponse_xml_accept TESTS ExtractedValidationResponseTest_xml_accept ResponseIsXml IntegrityRequestIDHeaderIsPresent IntegrityCorrelationIDHeaderIsPresent IntegrityRequestIDHeadersMatch IntegrityCorrelationIDHeadersMatch ResponseIsBundle
#ExtractedValidationResponse_json_accept TESTS ExtractedValidationResponseTest_json_accept ResponseIsJson IntegrityRequestIDHeaderIsPresent IntegrityCorrelationIDHeaderIsPresent IntegrityRequestIDHeadersMatch IntegrityCorrelationIDHeadersMatch ResponseIsBundle
END SCHEDULES

BEGIN TESTS
# new, SR status = complete, SR Category = validation, Encounter status = finished, Care Plan status = completed
ValidationResponseTest_xml_accept SEND_TKW validation_response TO __TO_ENDPOINT__/$process-message FROM __FROM_ENDPOINT__:__FROM_ENDPOINT_PORT__ SYNC ok WITH_PROPERTYSET base+webservices+post WITH_HTTPHEADERS credentials+Oauth2AccessToken+xml_accept+xml_content+integrity TEXT "HTTP Response must be HTTP 200"
ValidationResponseTest_json_accept SEND_TKW validation_response TO __TO_ENDPOINT__/$process-message FROM __FROM_ENDPOINT__:__FROM_ENDPOINT_PORT__ SYNC ok WITH_PROPERTYSET base+webservices+post WITH_HTTPHEADERS credentials+Oauth2AccessToken+json_accept+json_content+integrity TEXT "HTTP Response must be HTTP 200"

ExtractedValidationResponseTest_xml_accept SEND_TKW extracted_response TO __TO_ENDPOINT__/$process-message FROM __FROM_ENDPOINT__:__FROM_ENDPOINT_PORT__ PRETRANSFORM __TKWROOT__/config/FHIR_BaRS/autotest_config/transforms/validation_response.xslt APPLYPRETRANSFORMTO data SYNC ok WITH_PROPERTYSET base+webservices+post WITH_HTTPHEADERS credentials+Oauth2AccessToken+xml_accept+xml_content+integrity TEXT "HTTP Response must be HTTP 200"
ExtractedValidationResponseTest_json_accept SEND_TKW extracted_response TO __TO_ENDPOINT__/$process-message FROM __FROM_ENDPOINT__:__FROM_ENDPOINT_PORT__ PRETRANSFORM __TKWROOT__/config/FHIR_BaRS/autotest_config/transforms/validation_response.xslt APPLYPRETRANSFORMTO data SYNC ok WITH_PROPERTYSET base+webservices+post WITH_HTTPHEADERS credentials+Oauth2AccessToken+json_accept+json_content+integrity TEXT "HTTP Response must be HTTP 200"

# interim validation response, SR status = active, SR Category = validation, Encounter status = in-progress (no care plan?)


END TESTS

BEGIN MESSAGES
validation_response USING validation_response_template WITH NULL
extracted_response USING extracted_response_template WITH NULL
END MESSAGES

BEGIN TEMPLATES
validation_response_template __TKWROOT__/config/FHIR_BaRS/autotest_config/requests/validation_response___TO_SERVICE__.xml
extracted_response_template __TKWROOT__/config/FHIR_BaRS/autotest_config/requests/extracted_response.xml
END TEMPLATES

BEGIN PASSFAIL
END PASSFAIL
